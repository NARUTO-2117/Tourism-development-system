{% extends "TourismSystem/base.html" %}
{% block content %}
<div class="diary-detail-container">
    <h2>{{ diary.title }}</h2>
    <div class="diary-meta">
        <span>ä½œè€…ï¼š{{ diary.author.username }}</span> |
        <span>æ™¯ç‚¹ï¼š<a href="{% url 'attraction_detail' diary.attraction.id %}">{{ diary.attraction.name }}</a></span> |
        <span>è¯„åˆ†ï¼š
            {% for i in "12345" %}
                {% if i|add:'0' <= diary.rating|stringformat:"d" %}
                    <span style="color:#FFD700">&#9733;</span>
                {% else %}
                    <span style="color:#ccc">&#9733;</span>
                {% endif %}
            {% endfor %}
            ({{ diary.rating }}/5)
        </span> |
        <span>çƒ­åº¦ï¼š{{ diary.popularity }}</span> |
        <span>åˆ›å»ºæ—¶é—´ï¼š{{ diary.created_at|date:"Y-m-d H:i" }}</span>
    </div>
    <div class="diary-image">
        {% if diary.image %}
            <img src="{{ diary.image.url }}" alt="æ—¥è®°å›¾ç‰‡" style="max-width:400px;max-height:300px;">
        {% endif %}
    </div>
    <div class="diary-content" style="margin: 20px 0;">
        <p>{{ diary.content|linebreaksbr }}</p>
    </div>
    <div class="diary-actions">
        <form method="post" action="{% url 'diary_like' diary.id %}">
            {% csrf_token %}
            <button type="submit" class="btn btn-outline-primary">
                ğŸ‘ ç‚¹èµ ({{ diary.likes.count }})
            </button>
        </form>
    </div>
    <hr>
    <div class="diary-comments">
        <h4>è¯„è®º ({{ diary.comments.count }})</h4>
        {% for comment in diary.comments.all %}
            <div class="comment-item" style="margin-bottom:10px;">
                <b>{{ comment.author.username }}</b>ï¼š{{ comment.content }}
                <span style="color:#888;font-size:0.9em;">({{ comment.created_at|date:"Y-m-d H:i" }})</span>
            </div>
        {% empty %}
            <p>æš‚æ— è¯„è®ºï¼Œå¿«æ¥æŠ¢æ²™å‘ï¼</p>
        {% endfor %}
        <form method="post" action="{% url 'diary_comment' diary.id %}">
            {% csrf_token %}
            <textarea name="content" rows="2" placeholder="å†™ä¸‹ä½ çš„è¯„è®º..." required style="width:100%;margin-top:10px;"></textarea>
            <button type="submit" class="btn btn-success" style="margin-top:5px;">å‘è¡¨è¯„è®º</button>
        </form>
    </div>
</div>
{% endblock %}